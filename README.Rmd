---
output:
  md_document:
    variant: markdown_github
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, echo = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "README-"
)
```

**NOTE: This is a toy package created for expository purposes. The code is not intended to be used for any purpose**

### Hacking intervals

[Stuff about hacking intervals, to be improved]

There two types of hacking intervals:

* **Prescriptively constrained** hacking intervals give the range of results that could be achieved subject to user specified constraints.
* **Tethered** hacking intervals compute range of results that could be achieved subject to *any* manipulation so long as the loss changes by only a small amount. 

This package computes tethered and prescriptively constrained hacking intervals, as well as an interval that considers both types of hacking, for linear models. 

For the prescriptively constrained hacking intervals, up to one of the following modifications is considered at once:

* Removing any additive term in the base model.
* Applying a transformation (currently `x^2` only) to any linear term included in the base model. 
* Adding a linear term for any variable in the dataset. 
* Removing a single observation.

### Installation

```{r installation, eval = FALSE}
devtools::install_github("beauCoker/hacking")
```
  
### Quick demo

Sample data:

```{r}
N = 10
Px = 3
Pz = 3

set.seed(1)
data <- data.frame(
  y = rnorm(N), # Response variable (continuous)
  w = rbinom(N, 1, .5), # Treatment variable (binary)
  X = matrix(rnorm(N*Px), nrow=N), # Covariates included in base model
  Z = matrix(rnorm(N*Pz), nrow=N) # Covaraites excluded from base model
)
```

Fit a linear base model with `lm` and examine the coefficient on the treatment variable:

```{r}
mdl <- lm(y ~ w + X.1*X.2, data=data)
(beta_0 <- mdl$coefficients['w'])
```

The OLS estimate for the coefficent `beta_0` on the treatment variable `w` is `r beta_0`. Compute the hacking interval around this value with `hacking_lm`, allowing for a `theta = 0.5` percent change in the loss. 

```{r}
library(hacking)
output <- hackint_lm(mdl, data, theta=0.5)
```

This means that a tethered hacking interval around the base model is (`r round(output$tethered,2)`), a prescriptively constrained hacking interval around the base model is (`r round(output$constrained,2)`), and a hacking interval that considers both types is (`r round(output$tethered_and_constrained,2)`).

Here is the full output, sorted by the largest difference from `beta_0`:

```{r}
head(output$hacks_all)
```

